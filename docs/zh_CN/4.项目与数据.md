 # Ludork：2D RPG 工具包 - 帮助手册
 ## 项目与数据

 本章介绍 Ludork 如何组织项目数据，以及你在日常使用中会如何与这些数据交互。重点在于：一个 **Project（项目）** 包含哪些内容、不同类型的信息存放在哪里、以及当你创建、打开和保存内容时，底层发生了什么。

 在这里，**项目**指的是一个自洽的文件夹，它包含：
 - 引擎运行所需的全部结构化数据（地图、图块集、配置、可视化脚本等）。
 - 游戏实际使用的全部媒体资源（图片、音频、字体、着色器、系统图像等）。

 ### 项目概览

 当你在 Ludork 中打开一个项目时，编辑器会：
 - 将所选文件夹视为**项目根目录（Project Root）**。
 - 扫描其中与数据和资源相关的子目录，为文件列表、编辑器和预览面板填充内容。
 - 记录当前打开的地图、图块集、配置文件和公共函数等。

 在你工作时：
 - 不同编辑器会维护各自文档的未保存修改状态。
 - 当你执行保存时，这些修改会被写回到项目根目录下对应的文件中。
 - 随后，运行时引擎会读取同一批文件来运行你的游戏。

 可以把项目看作你游戏内容的“单一真实来源”。

 ### 项目结构

 Ludork 在项目内部使用统一的布局，以便编辑器和运行时能在约定位置找到需要的信息。一个典型项目通常包含：
 - 用于存放结构化游戏数据的 **Data** 目录。
 - 用于存放媒体资源的 **Assets** 目录（名称可根据项目约定调整）。
 - 一些可选的辅助文件，例如项目级配置或元数据。

 尽管具体命名可以根据需要调整，但通常会遵循类似约定。

 #### Data 目录

 `Data` 目录通常包含：
 - `Configs/` —— 系统与玩法相关的配置文件。
 - `Maps/` —— 瓦片地图定义以及相关元数据。
 - `Tilesets/` —— 图块集描述文件（说明图块集图片如何被解析和使用）。
 - `CommonFunctions/` —— 表示可复用逻辑块的可视化脚本图。

 这些文件通常使用 JSON 或二进制格式，编辑器和运行时都能读写。一般不建议直接手工修改，而是通过编辑器提供的各类工具来维护。

 #### Assets 目录

 `Assets` 目录（或功能等价的目录）保存游戏实际要显示或播放的媒体资源，例如：
 - `Characters/` —— 角色、敌人、NPC 及交互对象的图像资源。
 - `Tilesets/` —— 用于构建环境和背景的图块集图片。
 - `System/` —— 窗口皮肤、图标等 UI 相关图像。
 - `Musics/` —— 背景音乐。
 - `Sounds/` —— 音效。
 - `Shaders/` —— 用于转场、色调调整和特效的着色器程序。
 - `Fonts/` —— 字体文件及相关授权信息。

 编辑器通常不会直接修改这些媒体文件，而是通过配置和数据文件（例如使用相对路径）引用它们。

 #### 本地化数据

 支持多语言的项目会包含本地化数据，通常存放在与语言或区域设置相关的目录下。这些数据：
 - 将文本键映射到不同语言下的本地化字符串。
 - 会同时被编辑器 UI 与运行时使用，以在目标语言下显示文本。

 通常，你会使用专门的工具或外部编辑器维护本地化文件，然后将结果置于 Ludork 预期的位置。

 ### 创建新项目

 当你创建一个新项目时，一般会：
 - 选择一个空目录或已有目录作为项目根目录。
 - 初始化基本目录结构（例如创建 `Data`、`Assets` 及必要的子目录）。
 - 在 `Data/Configs` 下提供初始配置文件（例如游戏标题、分辨率、字体与着色器选择）。

 完成这些之后，你就可以开始：
 - 使用地图编辑器在 `Data/Maps` 下创建第一张地图。
 - 在 `Data/Tilesets` 下定义图块集，并指向 `Assets/Tilesets` 中的图块集图片。
 - 在 `Data/CommonFunctions` 下通过可视化图编辑器编写公共函数。

 编辑器会负责具体的数据文件创建与更新；你主要需要做好项目位置的选择，并根据需要为项目建立版本控制或备份。

 ### 打开与切换项目

 要编辑一个已有项目，你可以：
 - 启动编辑器并选择代表该项目的根目录。
 - 编辑器会扫描约定的子目录，并在文件列表和面板中展示可用内容。
 - 地图、图块集、配置文件和公共函数会出现在相应的工具中，供你选取和编辑。

 当你需要切换到另一个项目时：
 - 先在编辑器中关闭或离开当前项目。
 - 然后打开新的项目根目录，原项目的内容会从界面中卸载，替换为新项目的内容。

 在切换项目前，确保已保存当前项目中的所有重要修改是一个良好的习惯。

 ### 保存你的工作

 当你在不同窗口中编辑内容时：
 - 每个编辑器会跟踪当前文档是否有未保存的更改。
 - 当你执行保存操作时，编辑器会将更新后的数据写入项目根目录下对应的文件。

 典型的示例包括：
 - 保存地图会将其布局和元数据写入 `Data/Maps` 下的某个文件。
 - 保存图块集会更新 `Data/Tilesets` 中的图块集定义。
 - 保存公共函数会将可视化脚本图写回 `Data/CommonFunctions` 中的对应文件。
 - 保存配置修改会更新 `Data/Configs` 中的配置值。

 运行时引擎在下一次启动或预览游戏时，会读取这些最新的文件。

 ### 使用配置文件（Configs）

 配置文件用于定义项目的高层行为和默认值，例如：
 - 游戏窗口大小与标题。
 - 默认字体及字号。
 - 用于转场和后期处理的着色器路径。
 - UI 外观选项，例如窗口皮肤与颜色。

 你通常通过编辑器中的专用配置窗口来修改这些内容。在底层：
 - 编辑器会从 `Data/Configs` 下读取配置数据。
 - 当你调整选项并保存时，对应的配置文件会被更新。

 一致且合理的配置对于项目来说很重要：它可以保证不同地图、UI 元素和特效在整个项目中表现一致。

 ### 使用地图与图块集（Maps and Tilesets）

 从数据角度看，地图与图块集紧密相关：
 - **图块集（Tilesets）** 描述如何解释图块集图片：图块大小、碰撞或通行规则以及其他属性。
 - **地图（Maps）** 则引用这些图块集，并将图块排布成可游玩的区域。

 在实践中：
 - 图块集定义位于 `Data/Tilesets` 中，并引用 `Assets/Tilesets` 里的图块集图片。
 - 地图定义位于 `Data/Maps` 中，并引用一个或多个图块集。

 在地图和图块集工具中进行编辑时：
 - 实际更新的是 `Data` 目录下的相关数据文件。
 - 媒体资源不会被复制，而是通过路径引用 `Assets` 中的图像文件。

 这种分离可以让项目结构更加简洁，也更便于维护。

 ### 使用公共函数（Common Functions）

 公共函数以数据形式存放在 `Data/CommonFunctions` 中，用于表示可在游戏不同部分复用的逻辑模块。

 当你使用公共函数时：
 - 在节点图编辑器中打开某个公共函数。
 - 编辑器会从 `Data/CommonFunctions` 下对应的文件中加载其图结构。
 - 你可以通过添加或调整节点与连线来改变这段逻辑的行为。
 - 保存后，修改过的图会被写回同一文件。

 运行时引擎会在启动或按需加载这些图描述，并将其作为玩法逻辑的一部分执行，使用的项目数据与编辑器修改的是同一套。

 ### 管理资源（Assets）

 资源为项目提供视觉与听觉上的“外观与声音”。为了让它们更易管理，可以：
 - 按类型对资源进行分组（角色、图块集、系统 UI、音乐、音效、着色器、字体等）。
 - 使用清晰的文件命名，让文件名能大致说明用途而不仅是来源。
 - 避免在未同步更新引用的前提下随意移动或重命名资源文件。

 在编辑器中：
 - 资源浏览与预览面板可以帮助你在使用前快速检查图片、音频和着色器。
 - 各类配置和数据编辑器允许你将具体资源分配给一定的角色，例如选择某个窗口皮肤或背景音乐。

 由于运行时使用的资源路径与编辑器一致，保持资源目录结构整洁、一致，可以大幅减少游戏运行时出现缺失文件或引用错误的风险。

